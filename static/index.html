<html>
  <head>
    <title>Paataka</title>
  </head>

  <body>
    <div id="app">
      <ol>
        <li v-for="pub in publications">
          <a v-bind:href="'publication/' + pub.id">
            {{ pub.title }} ({{ pub.post_count }} Posts)
          </a>
        </li>
      </ol>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script>
      var app = new Vue({
        el: "#app",
        data: {
          publications: []
        },
        created: function() {
          this.fetchPublications();
        },
        methods: {
          fetchPublications(resource) {
            var xhr = new XMLHttpRequest();
            var self = this;
            xhr.open("GET", "/publications");
            xhr.onload = function() {
              var response = JSON.parse(xhr.responseText);
              self.publications = response.publications;
            };
            xhr.send();
          }
        }
      });
    </script>
  </body>
</html>
